<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>Paper.js stuff</title>
		<link rel="stylesheet" href="style.css" />
		<script type="text/javascript" src="jquery-1.6.1.js"></script>
		<script type="text/javascript" src="paper.js"></script>
		<script type="text/javascript" src="js.js"></script>
		<script type="text/javascript">
		// global tools so html can reference them
		var tool1, tool2;
		// declarations of library variables for jslint
		var paper;
		var $;
			$(function() {
				// Get a reference to the canvas object
				var canvas = $("#testcanvas").get(0);

				// Create an empty project and view for the canvas
				paper.setup(canvas);

				// create a path and make a line
				var path = new paper.Path();
				
				// set path color
				path.strokeColor = 'black';
				
				var start = new paper.Point(100,100);
				
				// move to start
				path.moveTo(start);
				
				// draw line to a new point
				path.lineTo(start.add([200, -50]));
				//path.selected = true;
				
				var circle = new paper.Path.Circle(new paper.Point(200,200), 80);
				circle.fillColor = 'black';
				//circle.selected = true;
				console.log(circle.segments);
				
				// draw little circles at the segment points of that circle
				//for(var segment in circle.segments) {
				/*$.each(circle.segments, function(index, segment) {
					var segmentcircle = new paper.Path.Circle(segment.point, 8);
					segmentcircle.fillColor = 'red';
					var handleInCircle = new paper.Path.Circle(segment.handleIn.add(segment.point), 4);
					handleInCircle.fillColor = 'green';
					//console.log(segment.point);
					//console.log(segment.handleIn);
					//console.log(segment);
				});*/
				
				// TODO was testing. figured out that it's options.segments, not options.segment
				// monte carlo simulation of trying to click on segments
				// define options for hit test
				/*var hitTestOptions = {
					//type: paper.PathItem, // TODO as a string or what? // I don't think this is used
					segments: true, // look for segment points
					handles: true, // look for segment handles
					selected: true, // look for selected paths
					tolerance:100
				};
				
				var hitCircle = new paper.Path.Circle(null, 3);
				hitCircle.fillColor = 'green';
				var hitSymbol = new paper.Symbol(hitCircle);
				var missCircle = new paper.Path.Circle(null, 3);
				missCircle.fillColor = 'red';
				var missSymbol = new paper.Symbol(missCircle);
				for(var i = 0; i < 1000; i++) {
					// perform hit test
					var testPoint = new paper.Point(Math.random()*400, Math.random()*400);
					var hitResult = paper.project.activeLayer.hitTest(testPoint, hitTestOptions);
					if(hitResult) {
						hitSymbol.place(testPoint);
					} else {
						missSymbol.place(testPoint);
					}
				}*/
				
				// draw the view
				paper.view.draw();
				
				/*paper.view.onFrame = function(event) {
					path.rotate(3);
				}*/
				
				var tool = new paper.Tool();
				var toolPath;
				tool.onMouseDown = function(event) {
					toolPath = new paper.Path();
					toolPath.strokeColor = 'black';
					toolPath.add(event.point);
				};
				
				tool.onMouseDrag = function(event) {
					toolPath.add(event.point);
				};
				
				// shared mouse down event
				var sharedToolPath;
				function mouseDownEvent(event) {
					sharedToolPath = new paper.Path();
					sharedToolPath.strokeColor = 'black';
					sharedToolPath.add(event.point);
				}
				
				tool1 = new paper.Tool();
				tool1.onMouseDown = mouseDownEvent;
				tool1.onMouseDrag = function(event) {
					sharedToolPath.add(event.point);
				};
				
				tool2 = new paper.Tool();
				tool2.minDistance = 20;
				tool2.onMouseDown = mouseDownEvent;
				tool2.onMouseDrag = function(event) {
					sharedToolPath.arcTo(event.point);
				};
				
				// make a new selected edit tool and activate it
				//var selectedEditTool = GetSelectedEditTool().activate();
				
				// make a new stock tool and actdivate it
				//var stockTool = GetStockTool().activate();
				app.stockTool.activate();
			});

		</script>
	</head>
	<body>
		<header>
			<h1>Paper.js stuff</h1>
		</header>
		<a href="javascript:tool1.activate();">Lines</a>
		<a href="javascript:tool2.activate();">Clouds</a>
		<canvas id="testcanvas" width="400px" height="400px"></canvas>
		<footer>
			&copy; sirctseb
		</footer>
	</body>
</html>